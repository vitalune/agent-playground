<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fractal Explorer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: #000000;
            color: #fff;
            overflow: hidden;
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 20px rgba(0, 255, 255, 0.5); }
            50% { box-shadow: 0 0 30px rgba(0, 255, 255, 0.8); }
        }

        .container {
            position: relative;
            width: 100vw;
            height: 100vh;
            background: #000;
        }

        canvas {
            display: block;
            cursor: crosshair;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
        }

        .controls {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.95);
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #0ff;
            animation: glow 2s ease-in-out infinite;
        }

        .controls h1 {
            color: #0ff;
            margin-bottom: 15px;
            font-size: 1.5em;
            text-shadow: 0 0 10px #0ff;
        }

        .control-group {
            margin: 10px 0;
        }

        .control-group label {
            display: block;
            margin-bottom: 5px;
            color: #0ff;
            font-size: 0.9em;
        }

        .control-group input[type="range"] {
            width: 200px;
        }

        .control-group button {
            background: #0ff;
            color: #000;
            border: none;
            padding: 8px 16px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            transition: all 0.3s;
        }

        .control-group button:hover {
            background: #fff;
            box-shadow: 0 0 15px #0ff;
        }

        .nav-links {
            position: absolute;
            bottom: 20px;
            left: 20px;
            display: flex;
            gap: 10px;
            z-index: 100;
        }

        .nav-links a {
            background: rgba(0, 0, 0, 0.95);
            color: #f0f;
            text-decoration: none;
            padding: 10px 20px;
            border-radius: 5px;
            border: 2px solid #f0f;
            font-weight: bold;
            transition: all 0.3s;
            text-shadow: 0 0 5px #f0f;
        }

        .nav-links a:hover {
            background: #f0f;
            color: #000;
            box-shadow: 0 0 15px #f0f;
            text-shadow: none;
        }

        .info {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.95);
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #ff0;
            max-width: 250px;
            z-index: 100;
        }

        .info p {
            color: #ff0;
            font-size: 0.85em;
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <canvas id="fractalCanvas"></canvas>

        <div class="controls">
            <h1>MANDELBROT EXPLORER</h1>
            <div class="control-group">
                <label>Max Iterations: <span id="iterValue">100</span></label>
                <input type="range" id="iterations" min="50" max="500" value="100">
            </div>
            <div class="control-group">
                <label>Color Shift: <span id="colorValue">0</span></label>
                <input type="range" id="colorShift" min="0" max="360" value="0">
            </div>
            <div class="control-group">
                <button id="resetBtn">Reset View</button>
                <button id="animateBtn">Animate</button>
            </div>
        </div>

        <div class="info">
            <p>Click to zoom in</p>
            <p>Shift+Click to zoom out</p>
            <p>Zoom: <span id="zoomLevel">1.00x</span></p>
        </div>

        <div class="nav-links">
            <a href="../index.html">Hub</a>
            <a href="julia.html">Julia Sets</a>
            <a href="lsystem.html">L-Systems</a>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('fractalCanvas');
        const ctx = canvas.getContext('2d');

        // Set canvas size
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        // Mandelbrot parameters
        let centerX = -0.5;
        let centerY = 0;
        let zoom = 1;
        let maxIterations = 100;
        let colorShift = 0;
        let isAnimating = false;

        // Controls
        const iterSlider = document.getElementById('iterations');
        const colorSlider = document.getElementById('colorShift');
        const resetBtn = document.getElementById('resetBtn');
        const animateBtn = document.getElementById('animateBtn');

        iterSlider.addEventListener('input', (e) => {
            maxIterations = parseInt(e.target.value);
            document.getElementById('iterValue').textContent = maxIterations;
            render();
        });

        colorSlider.addEventListener('input', (e) => {
            colorShift = parseInt(e.target.value);
            document.getElementById('colorValue').textContent = colorShift;
            render();
        });

        resetBtn.addEventListener('click', () => {
            centerX = -0.5;
            centerY = 0;
            zoom = 1;
            updateZoomDisplay();
            render();
        });

        animateBtn.addEventListener('click', () => {
            isAnimating = !isAnimating;
            animateBtn.textContent = isAnimating ? 'Stop' : 'Animate';
            if (isAnimating) animate();
        });

        // Canvas click for zoom
        canvas.addEventListener('click', (e) => {
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;

            // Convert to complex plane coordinates
            const zoomFactor = e.shiftKey ? 0.5 : 2;
            const rangeX = 3.5 / zoom;
            const rangeY = 2 / zoom;

            centerX += (x / canvas.width - 0.5) * rangeX;
            centerY += (y / canvas.height - 0.5) * rangeY;
            zoom *= zoomFactor;

            updateZoomDisplay();
            render();
        });

        function updateZoomDisplay() {
            document.getElementById('zoomLevel').textContent = zoom.toFixed(2) + 'x';
        }

        function mandelbrot(cx, cy) {
            let x = 0, y = 0;
            let iteration = 0;

            while (x*x + y*y <= 4 && iteration < maxIterations) {
                const xTemp = x*x - y*y + cx;
                y = 2*x*y + cy;
                x = xTemp;
                iteration++;
            }

            return iteration;
        }

        function getColor(iteration) {
            if (iteration === maxIterations) {
                return [0, 0, 0];
            }

            // Smooth coloring with logarithmic scale
            const smooth = iteration + 1 - Math.log(Math.log(2)) / Math.log(2);
            const hue = (smooth * 8 + colorShift) % 360;
            const saturation = 100;
            const lightness = 50 + 20 * Math.sin(smooth * 0.5);

            return hslToRgb(hue, saturation, lightness);
        }

        function hslToRgb(h, s, l) {
            s /= 100;
            l /= 100;
            const k = n => (n + h / 30) % 12;
            const a = s * Math.min(l, 1 - l);
            const f = n => l - a * Math.max(-1, Math.min(k(n) - 3, Math.min(9 - k(n), 1)));
            return [Math.floor(255 * f(0)), Math.floor(255 * f(8)), Math.floor(255 * f(4))];
        }

        function render() {
            // Clear canvas to black first
            ctx.fillStyle = '#000';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            const imageData = ctx.createImageData(canvas.width, canvas.height);
            const rangeX = 3.5 / zoom;
            const rangeY = 2 / zoom;

            for (let px = 0; px < canvas.width; px++) {
                for (let py = 0; py < canvas.height; py++) {
                    const x0 = centerX + (px / canvas.width - 0.5) * rangeX;
                    const y0 = centerY + (py / canvas.height - 0.5) * rangeY;

                    const iteration = mandelbrot(x0, y0);
                    const [r, g, b] = getColor(iteration);

                    const index = (py * canvas.width + px) * 4;
                    imageData.data[index] = r;
                    imageData.data[index + 1] = g;
                    imageData.data[index + 2] = b;
                    imageData.data[index + 3] = 255;
                }
            }

            ctx.putImageData(imageData, 0, 0);
        }

        function animate() {
            if (!isAnimating) return;

            colorShift = (colorShift + 1) % 360;
            colorSlider.value = colorShift;
            document.getElementById('colorValue').textContent = colorShift;
            render();

            requestAnimationFrame(animate);
        }

        // Handle window resize
        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            render();
        });

        // Initial render
        render();
    </script>
</body>
</html>
